---
title: Analyzing Failure Cases
description: Helps analyse failure causes in a RAG pipeline.
---

UpTrain helps analyze failure causes in a RAG pipeline. Using it you can highlight failure causes such as:
- `Poor Retrieval`: The context does not have information relevant to the question asked.
- `Hallucinations`: The generated response is not factually correct.
- `Poor Citation`: The cited information is not factually correct.
- `Poor Context Utilization`: The cited information is not relevant to the question asked.

Columns required:
- `question`: The question asked by the user
- `context`: Additional information provided that can be used to answer the question
- `cited_context`: Information retieved from the context
- `response`: The response given by the model

### How to use it?

```python
from uptrain import RcaTemplate, EvalLLM
import json

OPENAI_API_KEY = "sk-*******"     # Insert your OpenAI key here

eval_llm = EvalLLM(openai_api_key=OPENAI_API_KEY)  

data = [{
        'question': 'Which team won the 2023 ICC Cricket World Cup?',
        'context': 'Argentina won the 2022 FIFA World Cup. The 2022 FIFA World Cup took place in Qatar from 20 November to 18 December 2022. The previous FIFA World Cup was held in Russia.',
        'cited_context': 'The 2022 FIFA World Cup took place in Qatar from 20 November to 18 December 2022',
        'response': 'The 2023 ICC Cricket World Cup was won by Qatar.'        
    }]

res = eval_llm.perform_root_cause_analysis(
    data = data,
    rca_template = RcaTemplate.RAG_WITH_CITATION
)

print(json.dumps(res,indent=3))
```
<Info>You can get your UpTrain key [here](https://uptrain.ai/).</Info>

Sample Response:
```json
[
   {
      "question": "Which team won the 2023 ICC Cricket World Cup?",
      "context": "Argentina won the 2022 FIFA World Cup. The 2022 FIFA World Cup took place in Qatar from 20 November to 18 December 2022. The previous FIFA World Cup was held in Russia.",
      "cited_context": "The 2022 FIFA World Cup took place in Qatar from 20 November to 18 December 2022",
      "response": "The 2023 ICC Cricket World Cup was won by Qatar.",
      "error_mode": "Poor Retrieval",
      "error_resolution_suggestion": "Context Retrieval Pipeline needs improvement",
      "score_question_completeness": 1,
      "score_valid_response": 1.0,
      "explanation_valid_response": "{\n    \"Reasoning\": \"The response 'The 2023 ICC Cricket World Cup was won by Qatar' provides the name of a team. Therefore, the response does contain information relevant to the question.\",\n    \"Choice\": \"A\"\n}",
      "score_context_relevance": 0.0,
      "explanation_context_relevance": "{\n    \"Reasoning\": \"The given context does not contain any information about the 2023 ICC Cricket World Cup or the team that won it. The context only provides information about the 2022 FIFA World Cup and its location. Therefore, the extracted context doesn't contain any information to answer the given query.\",\n    \"Choice\": \"C\"\n}",
      "score_factual_accuracy": 0.0,
      "explanation_factual_accuracy": "[\n    {\n        \"Fact\": \"1. The 2023 ICC Cricket World Cup was won by Qatar.\",\n        \"Reasoning\": \"The context only mentions the 2022 FIFA World Cup taking place in Qatar, but it does not provide any information about the 2023 ICC Cricket World Cup.\",\n        \"Judgement\": \"no\"\n    }\n]",
      "score_cited_context_relevance": 0.0,
      "explanation_cited_context_relevance": "{\n    \"Reasoning\": \"The given context does not contain any information about the 2023 ICC Cricket World Cup or the winner of the tournament. It only provides information about the 2022 FIFA World Cup. Therefore, the extracted context doesn't contain any information to answer the given query.\",\n    \"Choice\": \"C\"\n}",
      "score_factual_accuracy_wrt_cited": 0.0,
      "explanation_factual_accuracy_wrt_cited": "[\n    {\n        \"Fact\": \"1. The 2023 ICC Cricket World Cup was won by Qatar.\",\n        \"Reasoning\": \"The context only mentions the 2022 FIFA World Cup taking place in Qatar, but it does not provide any information about the 2023 ICC Cricket World Cup.\",\n        \"Judgement\": \"no\"\n    }\n]"
   }
]
```

The question asked is "Which team won the 2023 ICC Cricket World Cup?".

The context has information about FIFA World Cup, but it has no information on ICC Cricket World Cup.

Thus, the context is not relevant for the question being asked.

Hence, the error mode in this example is `Poor Retrieval`


<CardGroup cols={2}>
  <Card
    title="Tutorial"
    href="https://github.com/uptrain-ai/uptrain/blob/main/examples/root_cause_analysis/rag_with_citation.ipynb"
    icon="github"
    color="#808080"
  >
    Open this tutorial in GitHub
  </Card>
  <Card
    title="Have Questions?"
    href="https://join.slack.com/t/uptraincommunity/shared_invite/zt-1yih3aojn-CEoR_gAh6PDSknhFmuaJeg"
    icon="slack"
    color="#808080"
  >
    Join our community for any questions or requests
  </Card>
</CardGroup>